/dts-v1/;
#include "mt7981.dtsi"

#include <dt-bindings/input/input.h>

/ {
	model = "ZX7981PM";
	compatible = "ZX7981PM";
	chosen {
		bootargs = "console=ttyS0,115200n1 loglevel=8  \
				earlycon=uart8250,mmio32,0x11002000";
	};

	// 定义内存大小 (256MB: 128MB * 2)
	memory {
		reg = <0 0x40000000 0 0x20000000>;
	};

	// LED 定义
	gpio-leds {
		compatible = "gpio-leds";

		5gblue {
			label = "lede:blue:5gblue";
			gpios = <&pio 12 0>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		5gyellow {
			label = "lede:blue:5gyellow";
			gpios = <&pio 11 0>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		wifi {
			label = "lede:blue:wifi";
			gpios = <&pio 9 0>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		4gblue {
			label = "lede:blue:4gblue";
			gpios = <&pio 10 0>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		4gyellow {
			label = "lede:blue:4gyellow";
			gpios = <&pio 13 0>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		lan2 {
			label = "lede:blue:lan2";
			gpios = <&pio 4 1>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		lan3 {
			label = "lede:blue:lan3";
			gpios = <&pio 22 1>;
			linux,default-trigger = "none";
			default-state = "off";
		};

		wan {
			label = "lede:blue:wan";
			gpios = <&pio 8 1>;
			linux,default-trigger = "none";
			default-state = "off";
		};
	};

	// GPIO 控制 (风扇 & 5G 模块)
	gpio-export {
		compatible = "gpio-export";

		5gpower {
			gpio-export,name = "5gpower";
			gpio-export,output = <0>; // 默认关闭
			gpios = <&pio 25 0>;    // GPIO 25 低电平激活
		};

		fan {
			gpio-export,name = "fan";
			gpio-export,output = <1>; // 默认开启
			gpios = <&pio 5 0>;    // GPIO 5 低电平激活
		};

		5gpwrkey {
			gpio-export,name = "5gpwrkey";
			gpio-export,output = <0>; // 默认关闭
			gpios = <&pio 2 0>;    // GPIO 2 低电平激活
		};

		5gsim {
			gpio-export,name = "5gsim";
			gpio-export,output = <1>; // 默认开启
			gpios = <&pio 15 0>;    // GPIO 15 低电平激活
		};
	};

	// 按键定义
	gpio-keys {
		compatible = "gpio-keys";
		#address-cells = <1>;
		#size-cells = <0>;
		poll-interval = <20>;

		reset {
			label = "reset";
			gpios = <&pio 1 1>;
			linux,code = <KEY_RESTART>;
		};

		wps {
			label = "wps";
			gpios = <&pio 7 1>;
			linux,code = <KEY_WPS_BUTTON>;
		};
	};

	// UART 串口启用
	&uart0 {
		status = "okay";
	};

	// 启用看门狗
	&watchdog {
		status = "okay";
	};

	// 启用网络
	&eth {
		status = "okay";
	};

	// 启用 USB
	&xhci {
		mediatek,u3p-dis-msk = <0x0>;
		phys = <&u2port0 PHY_TYPE_USB2>,
		       <&u3port0 PHY_TYPE_USB3>;
		status = "okay";
	};
};
